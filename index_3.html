<html><head><title>wgld.org WebGL sample</title><script src="main_2.js" type="text/javascript"></script><script id="fs" type="x-shader/x-fragment">precision mediump float;
  uniform float time;
  uniform vec2  mouse;
  uniform vec2  resolution;
  uniform sampler2D texture;

  varying vec4 vColor;
  varying vec2 vTextureCoord;

  vec2 params = vec2(1.5, 5.0);
	
// Simple circular wave function
float wave(vec2 pos, float t, float freq, float numWaves, vec2 center) {
	float d = length(pos - center);
	d = log(1.0 + exp(d));
	return 1.0/(1.0+20.0*d*d) *
		   sin(2.0*3.1415*(-numWaves*d + t*freq));
}

// This height map combines a couple of waves
float height(vec2 pos, float t) {
	float w;
	w =  wave(pos, t, params.x, params.y, vec2(0.5, -0.5));
	w += wave(pos, t, params.x, params.y, -vec2(0.5, -0.5));
	return w;
}

// Discrete differentiation
vec2 normal(vec2 pos, float t) {
	return 	vec2(height(pos - vec2(0.01, 0), t) - height(pos, t), 
				 height(pos - vec2(0, 0.01), t) - height(pos, t));
}
          
  void main(void){
    vec2 uv = gl_FragCoord.xy / resolution.xy;
    vec2 uvn = 4.0*uv - vec2(1.0);	
    uv += normal(uvn, time);
    vec4 smpColor = texture2D(texture, vec2(uv.x, 1.0-uv.y));
    gl_FragColor  = smpColor;
  }
  </script>
        
  <script id="vs" type="x-shader/x-vertex">
    attribute vec3 position;
    attribute vec4 color;
    attribute vec2 textureCoord;

    varying   vec4 vColor;
    varying   vec2 vTextureCoord;
    
    void main(void){
      vColor = color;
      vTextureCoord = textureCoord;
      gl_Position = vec4(position, 1.0);
    }
  </script>

  <style type="text/css">
    * {
        text-align: center;
        margin: 10px auto;
        padding: 0px;
    }
    body {

    }
    canvas {
        box-shadow: 0px 0px 0px 1px gray;
        
    }
</style>
        
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <p><input type="checkbox" id="check" checked><label for="check"> auto run</label></p>
  </body>
</html>